<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Level set method vs threshold dynamics &mdash; Literature 0.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/documentation_options.js?v=7c91f8fd"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=beaddf03"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Literature
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../SPDE/ES2012MJM.html">An ALE ESFEM for solving PDEs on evolving surfaces</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Literature</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Level set method vs threshold dynamics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/LCMCF/MedianFilter.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Level-set-method-vs-threshold-dynamics">
<h1>Level set method vs threshold dynamics<a class="headerlink" href="#Level-set-method-vs-threshold-dynamics" title="Link to this heading">¶</a></h1>
<section id="Level-set-method">
<h2>Level set method<a class="headerlink" href="#Level-set-method" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>OS1988JCP</p></li>
<li><p>elegent, convergence</p></li>
<li><p>drawback: lower accuracy in time, time step restriction, hard to extended to network: correct junction conditions at free boundaries</p></li>
<li><p>advantage: spatial accuracy on uniform grid</p></li>
</ul>
</section>
<section id="threshold-dynamics">
<h2>threshold dynamics<a class="headerlink" href="#threshold-dynamics" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>MBO1994JCP</p></li>
<li><p>advantage: network</p></li>
<li><p>drawback: low accuracy on uniform spatial grids – represents interface by characteristic functions</p></li>
</ul>
</section>
<section id="median-filter-scheme">
<h2>median filter scheme<a class="headerlink" href="#median-filter-scheme" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Oberman2004NM, GMR</p></li>
<li></li>
</ul>
<p>Level set PDE for mean curvature flow <span class="math">\begin{align*}
\phi_t=|\nabla \phi| \nabla \cdot\left(\frac{\nabla \phi}{|\nabla \phi|}\right)
\end{align*}</span> An explicit solution <span class="math">\begin{equation*}
\phi = \sin(2 \pi (x-y))
\end{equation*}</span> this function satisfies the above PDE on the unit square with periodic boundary condition since <span class="math">\begin{equation*}
\nabla \phi = 2 \pi \cos(2 \pi (x-y))
\begin{pmatrix}
1 \\
-1
\end{pmatrix},\quad
\frac{\nabla \phi}{|\nabla \phi|} = C
\end{equation*}</span></p>
<section id="Derivation-of-the-median-filter-method">
<h3>Derivation of the median filter method<a class="headerlink" href="#Derivation-of-the-median-filter-method" title="Link to this heading">¶</a></h3>
<p>Discretize in time by Euler method</p>
<p><span class="math">\begin{equation*}
\phi^{n+1}- \phi^n = k |\nabla \phi^n| \nabla\cdot \left( \frac{\nabla \phi^n}{|\nabla \phi^n|}\right)
\end{equation*}</span> When <span class="math notranslate nohighlight">\(\phi\)</span> is sufficiently differentiable and <span class="math notranslate nohighlight">\(\nabla \phi(x)\not=0\)</span>, <span class="math">\begin{align*}
|\nabla \phi| \nabla \cdot\left(\frac{\nabla \phi}{|\nabla \phi|}\right)
&=\Delta \phi(x)-\left\langle D^2 \phi(x) \frac{\nabla \phi}{|\nabla \phi|}, \frac{\nabla \phi}{|\nabla \phi|}\right\rangle\\
&=\left\langle D^2 \phi(x) \frac{\nabla^{\perp} \phi(x)}{\left|\nabla^{\perp} \phi(x)\right|}, \frac{\nabla^{\perp} \phi(x)}{\left|\nabla^{\perp} \phi(x)\right|}\right\rangle \quad \textrm{tangential surface Laplacian}\\
&\approx \frac{{M}_r \phi(x)-2 \phi(x)+{M}_r \phi(x)}{r^2}\quad \textrm{by median value of level set function}.
\end{align*}</span> Taking <span class="math notranslate nohighlight">\(r=\sqrt{2k}\)</span>, the scheme becomes <span class="math">\begin{equation*}
\phi^{n+1}(x) = M_r \phi^n(x)
\end{equation*}</span> This gives the iteration of all values of <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
</section>
</section>
<section id="viscosity-solution">
<h2>viscosity solution<a class="headerlink" href="#viscosity-solution" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li></li>
</ul>
</section>
<section id="Weighted-median-filter">
<h2>Weighted median filter<a class="headerlink" href="#Weighted-median-filter" title="Link to this heading">¶</a></h2>
<div class="math notranslate nohighlight">
\[K_r(x)=\frac{1}{r^d} K\left(\frac{x}{r}\right) .\]</div>
<p>For <span class="math notranslate nohighlight">\(K\)</span> with support set <span class="math notranslate nohighlight">\(B_1(0)\)</span>, then <span class="math notranslate nohighlight">\(\textrm{supp}(K_r) = B_r(0)\)</span></p>
<p>For a bounded, continuous function <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\lambda \in \mathbb{R}\)</span>, let</p>
<div class="math notranslate nohighlight">
\[{T}_\lambda \phi=\{x: \phi(x) \geq \lambda\} \text {. }\]</div>
<p>The function</p>
<div class="math notranslate nohighlight">
\[\psi_K \phi(x, \lambda)=\int_{T_\lambda \phi} K(x-y) d y\]</div>
<p>is decreasing (since <span class="math notranslate nohighlight">\(K \geq 0\)</span> ) and left continuous in <span class="math notranslate nohighlight">\(\lambda\)</span>, satisfying</p>
<div class="math notranslate nohighlight">
\[\lim _{\lambda \rightarrow \infty} \psi_K \phi(x, \lambda)=0 \text { and } \lim _{\lambda \rightarrow-\infty} \psi_K \phi(x, \lambda)=1 .\]</div>
<p>Define the weighted median of <span class="math notranslate nohighlight">\(\phi\)</span> at <span class="math notranslate nohighlight">\(x\)</span> with respect to the weight <span class="math notranslate nohighlight">\(K\)</span> as</p>
<div class="math notranslate nohighlight">
\[{M}_K \phi(x)=\sup \left\{\lambda: \psi_K \phi(x, \lambda) \geq \frac{1}{2}\right\} .\]</div>
<p>Variational description</p>
<p><span class="math">\begin{equation*}
{M}_K \phi(x) \in \underset{\xi}{\arg \min } \int|\xi-\phi(y)| K(x-y) d y
\end{equation*}</span> We have :nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>begin{align*}
<a href="#id3"><span class="problematic" id="id4">|</span></a>xi-phi(y)|&amp;=int_{-infty}^{xi} {1}_{left({T}_lambda phiright)^c}(y) d lambda</p>
<blockquote>
<div><blockquote>
<div><p>+int_{xi}^{infty} {1}_{{T}_lambda phi}(y) d lambda</p>
</div></blockquote>
<dl class="simple">
<dt>= int_{-infty, phi(y)&lt; lambda}^{xi} 1 d lambda</dt><dd><p>+int_{xi, phi(y)&gt; lambda}^{infty} 1 d lambda\</p>
</dd>
</dl>
<p>&amp;= | xi - phi(y)|_+ + | phi(y) - xi <a href="#id5"><span class="problematic" id="id6">|</span></a>_+</p>
</div></blockquote>
<p>end{align*}`</p>
<p>so that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
C(\xi): &amp; =\int|\xi-\phi(y)| K(x-y) d y \\
&amp; =\int_{-\infty}^{\xi} \int_{\left({T}_\lambda \phi\right)^c} K(x-y) d y d \lambda+\int_{\xi}^{\infty} \int_{{T}_\lambda \phi} K(x-y) d y d \lambda \\
&amp; =\int_{-\infty}^{\xi} 1-\psi_K \phi(x, \lambda) d \lambda+\int_{\xi}^{\infty} \psi_K \phi(x, \lambda) d \lambda
\end{aligned}\end{split}\]</div>
<section id="Examples-of-K">
<h3>Examples of <span class="math notranslate nohighlight">\(K\)</span><a class="headerlink" href="#Examples-of-K" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="Threshold-Dynamics">
<h2>Threshold Dynamics<a class="headerlink" href="#Threshold-Dynamics" title="Link to this heading">¶</a></h2>
<p><span class="math">\begin{equation*}
{S}_K \Sigma=\left\{x: K * {1}_{\Sigma}(x) \geq \frac{1}{2}\right\} = T_{\frac12}K*{1}_{\Sigma}
\end{equation*}</span></p>
<section id="Variational-Formulation">
<h3>Variational Formulation<a class="headerlink" href="#Variational-Formulation" title="Link to this heading">¶</a></h3>
<p><span class="math">\begin{equation*}
\begin{aligned}
\Sigma^{n+1} & ={T}_{\frac{1}{2}} K * {1}_{\Sigma^n}=\underset{\Sigma}{\arg \min } \int_{\Sigma} 1-2 K * {1}_{\Sigma^n} d x \\
& =\underset{\Sigma}{\arg \min } \int_{\Sigma^c} K * {1}_{\Sigma} d x+\int\left({1}_{\Sigma}-{1}_{\Sigma^n}\right) K *\left({1}_{\Sigma}-{1}_{\Sigma^n}\right) d x
\end{aligned}
\end{equation*}</span></p>
<p><span class="math">\begin{align*}
\int_{\Sigma} 1-2 K * {1}_{\Sigma^n} d x
&= \int_{\Sigma} 1- K * {1}_{\Sigma^n} d x -
\int_{\Sigma} K * {1}_{\Sigma^n} d x \\
&= (1_{\Sigma}, 1_{\Sigma^{n,c}}) - (1_ \Sigma , 1_{ \Sigma^n})\\
&= (1_ \Sigma,1_{ \Sigma^c}) + (1_ \Sigma, 1_{\Sigma}-1_{ \Sigma^n})-(1_ \Sigma,1_{\Sigma^n})\\
&= (1_{ \Sigma^c}, 1_ \Sigma) + (1_ \Sigma-1_{ \Sigma^n}, 1_{\Sigma}-1_{ \Sigma^n})-(1_{\Sigma^n},1_{\Sigma^n})
\end{align*}</span> When the Fourier transform <span class="math notranslate nohighlight">\(\hat K\)</span> is positive, then <span class="math">\begin{equation}\tag{*}
\int (1_{\Sigma} - 1_{\Sigma^n}) K*(1_{\Sigma} - 1_{\Sigma^n}) dx
\end{equation}</span> is positive. It is a movement limiter. In particular for energy <span class="math">\begin{equation*}
E_K(\Sigma) = \int_{ \Sigma^{c}} K*1_{ \Sigma}
\end{equation*}</span> <span class="math notranslate nohighlight">\(E_K(\Sigma^{n+1})\le E_K(\Sigma^n)\)</span></p>
</section>
</section>
<section id="Connection-between-median-filter-and-threshold-dynamics">
<h2>Connection between median filter and threshold dynamics<a class="headerlink" href="#Connection-between-median-filter-and-threshold-dynamics" title="Link to this heading">¶</a></h2>
<p>The threshold for some super level set is exactly the super level set of the weighted median <span class="math">\begin{equation*}
\begin{aligned}
&{S}_K {T}_\lambda \phi={T}_\lambda {M}_K \phi
\end{aligned}
\end{equation*}</span> Then <span class="math notranslate nohighlight">\(M_K \phi(x)=\sup \left\{\lambda: x \in {S}_K {T}_\lambda \phi\right\}\)</span> In the terminology of [16], median schemes are the stacked filter versions of threshold dynamics scheme</p>
</section>
<section id="Variational-Formulation-of-Median-Schemes">
<h2>Variational Formulation of Median Schemes<a class="headerlink" href="#Variational-Formulation-of-Median-Schemes" title="Link to this heading">¶</a></h2>
<p>Define Energy (1. Is it possible to start from the energy? 2. Differentiable energy, square type) <span class="math">\begin{equation*}
\mathcal{E}_K(\phi)=\iint K(x-y)|\phi(x)-\phi(y)| d x d y
\end{equation*}</span> ### Relations * Description of positive part by level set <span class="math">\begin{equation*}
\int_{\mathbb{R}} {1}_{{T}_\lambda \phi}(y)\left(1-{1}_{{T}_\lambda \phi}(x)\right) d \lambda=(\phi(y)-\phi(x))_{+}
\end{equation*}</span> We have <span class="math">\begin{align*}
\mathcal{E}_K(\phi)=\iint K(x-y)|\phi(x)-\phi(y)| d x d y
&= 2\iint K(x-y)(\phi(x)-\phi(y))_+ d x d y\\
&= 2\int (1_{T_ \lambda \phi}, 1_{T_ \lambda \phi^c})d \lambda = 2 \int E_K(T_ \lambda \phi) d\lambda
\end{align*}</span> * Energy of superlevel set and Energy of <span class="math notranslate nohighlight">\(\phi\)</span> <span class="math">\begin{align*}
\int E_K(T_ \lambda \phi) d \lambda = \frac12 \mathcal{E}_K( \phi)
\end{align*}</span> * <span class="math notranslate nohighlight">\(\mathcal{E}_K\)</span> is the Lyapunov function of the median filter <span class="math notranslate nohighlight">\(\phi^{n+1} = M_K \phi^n\)</span>.</p>
<p>Variational form <span class="math">\begin{align*}
\phi^{n+1} \in \underset{\phi}{\arg \min } \mathcal{E}_K(\phi)+\mathcal{M}_n(\phi)
\end{align*}</span> where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathcal{M}_n(\phi)=\iint K(x-y)( &amp; 2\left|\phi(x)-\phi^n(y)\right| \\
&amp; \left.-|\phi(x)-\phi(y)|-\left|\phi^n(x)-\phi^n(y)\right|\right) d x d y
\end{aligned}\end{split}\]</div>
<p>This is the integral of the energy movement limiter in (*) <span class="math">\begin{align*}
\iint\left(\mathbf{1}_{T_\lambda \phi}-\mathbf{1}_{T_\lambda \phi^n}\right) K *\left(\mathbf{1}_{T_\lambda \phi}-\mathbf{1}_{T_\lambda \phi^n}\right) d x d \lambda
\end{align*}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<section id="local-median-filter">
<h3>local median filter<a class="headerlink" href="#local-median-filter" title="Link to this heading">¶</a></h3>
</section>
<section id="weighted-median-filter">
<h3>weighted median filter<a class="headerlink" href="#weighted-median-filter" title="Link to this heading">¶</a></h3>
</section>
<section id="two-phase-threshold-dynamics">
<h3>two-phase threshold dynamics<a class="headerlink" href="#two-phase-threshold-dynamics" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>convolution</p></li>
<li><p>thresholding</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, chuya.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>